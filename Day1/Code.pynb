%pip install kaggle 

#Configure Kaggle API
import os

os.environ["KAGGLE_USERNAME"] = "souvanikchaudhury"
os.environ["KAGGLE_KEY"] = "b27df572e24f5ef21668f11a564bf1a4"

print("Kaggle credentials configured!")

#Create Schema

spark.sql("""
CREATE SCHEMA IF NOT EXISTS workspace.ecommerce
""")

#Create Volume

spark.sql("""
CREATE VOLUME IF NOT EXISTS workspace.ecommerce.ecommerce_data
""")

#Download Dataset to Volume

%sh
cd /Volumes/workspace/ecommerce/ecommerce_data
kaggle datasets download -d mkechinov/ecommerce-behavior-data-from-multi-category-store


#Unzip Dataset

%sh
cd /Volumes/workspace/ecommerce/ecommerce_data
unzip -o ecommerce-behavior-data-from-multi-category-store.zip
ls -lh


#Remove ZIP (keep CSVs)

 %sh
cd /Volumes/workspace/ecommerce/ecommerce_data
rm -f ecommerce-behavior-data-from-multi-category-store.zip
ls -lh


#Read Code (CSV File)

oct_events = spark.read.csv(
    "/Volumes/workspace/ecommerce/ecommerce_data/2019-Oct.csv",
    header = True,
    inferSchema = True
)

nov_events = spark.read.csv("/Volumes/workspace/ecommerce/ecommerce_data/2019-Nov.csv",
header = True,
inferSchema = True
)

nov_events.display()
oct_events.display()
